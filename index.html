<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; media-src 'self' blob:; frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com; child-src 'self' https://www.youtube.com https://www.youtube-nocookie.com; connect-src 'self' https://api.dropboxapi.com https://content.dropboxapi.com https:; object-src 'self' blob:; base-uri 'self'; form-action 'self'">
    <title>EduKanban ‚Äî Gestor de Actividades</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#35424a">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéì</text></svg>">
</head>
<body>
    <header>
        <div class="header-top">
            <img src="icons/logolargo.png" alt="EduKanban" class="logo"/>
            <div class="acciones">
                <button id="abrir-popup-tarea" type="button" class="boton-accion boton-primario">‚ûï Nueva Actividad</button>
                <button id="open-admin" type="button" class="boton-accion" aria-haspopup="dialog" aria-controls="admin-modal">‚öôÔ∏è Administraci√≥n</button>
            </div>
        </div>
        <nav class="main-nav" role="tablist">
            <a href="index.html" class="tab active" role="tab" aria-selected="true">Tablero</a>
            <a href="recordatorios.html" class="tab" role="tab" aria-selected="false">Recordatorios</a>
            <a href="archivo.html" class="tab" role="tab" aria-selected="false">Archivo</a>
            <a href="historico.html" class="tab" role="tab" aria-selected="false">Hist√≥rico</a>
        </nav>
    </header>
    <main>
   <label id="filter-tag-label" for="filter-tag">Filtrar por etiqueta:</label>
    <select id="filter-tag">
        <option value="">-- Filtrar por etiqueta --</option>
    </select>
    <label id="filter-column-label" style="margin-left:12px;">Ver columnas:</label>
    <div id="filter-column-group" class="filter-columns" aria-label="Ver columnas"></div>
    <div class="filter-column-actions" style="display:inline-flex; gap:8px; margin-left:12px;">
        <button id="filter-column-apply" type="button" class="boton-accion">Aplicar</button>
        <button id="filter-column-reset" type="button" class="boton-accion">Resetear</button>
    </div>

        <div id="task-container"></div>
    </main>

  
       
     <!--   <div class="grupo-botones">
            <h3>Administraci√≥n</h3>
            <button id="clear-data-btn" type="button" class="boton-accion boton-peligro">üóëÔ∏è Limpiar Datos</button>
        </div>
    </div>-->

    <!-- Popup para nueva tarea -->
    <div id="popup-tarea" class="modal">
        <div class="modal-content">
            <form id="popup-task-form">
                <textarea id="popup-task-name" placeholder="Nueva actividad" rows="8"></textarea>
                <select id="popup-task-category">
                    <option value="en-preparacion">En preparaci√≥n</option>
                    <option value="preparadas">Preparadas</option>
                    <option value="en-proceso">En proceso</option>
                    <option value="pendientes">Pendientes</option>
                </select>
                <label for="popup-task-order">Orden (A‚ÄìZ)</label>
                <select id="popup-task-order">
                    <option value=""></option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="C">C</option>
                    <option value="D">D</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="G">G</option>
                    <option value="H">H</option>
                    <option value="I">I</option>
                    <option value="J">J</option>
                    <option value="K">K</option>
                    <option value="L">L</option>
                    <option value="M">M</option>
                    <option value="N">N</option>
                    <option value="O">O</option>
                    <option value="P">P</option>
                    <option value="Q">Q</option>
                    <option value="R">R</option>
                    <option value="S">S</option>
                    <option value="T">T</option>
                    <option value="U">U</option>
                    <option value="V">V</option>
                    <option value="W">W</option>
                    <option value="X">X</option>
                    <option value="Y">Y</option>
                    <option value="Z">Z</option>
                </select>
                <textarea id="popup-task-tags" placeholder="Etiquetas (separadas por comas)" rows="3"></textarea>
                <datalist id="all-tags-list"></datalist>
                <div id="tag-suggestions" class="tag-suggestions"></div>
                <label for="popup-task-reminder">Recordatorio (fecha y hora)</label>
                <input type="datetime-local" id="popup-task-reminder">
                <label for="popup-task-attachments">Adjuntos</label>
                <input type="file" id="popup-task-attachments" multiple>
                <div id="popup-existing-attachments" class="attachments"></div>
                <button type="button" id="popup-attach-reuse-toggle" class="boton-accion">üîÅ Reutilizar adjunto</button>
                <div id="popup-attach-reuse-panel" class="reuse-panel" style="display:none"></div>
                <div class="acciones-popup">
                    <button type="submit">A√±adir</button>
                    <button type="button" id="cancelar-popup">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n gen√©rico -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content">
            <div id="confirm-message" class="confirm-message">¬øConfirmas esta acci√≥n?</div>
            <div class="acciones-popup">
                <button type="button" id="confirm-accept" class="boton-peligro">Eliminar</button>
                <button type="button" id="confirm-cancel">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Administraci√≥n -->
    <div id="admin-modal" class="modal">
        <div class="modal-content">
            <h2>Administraci√≥n</h2>
            <div class="grupo-botones" id="lang-group">
                <h3>Idioma</h3>
                <select id="lang-select">
                    <option value="es">Espa√±ol</option>
                    <option value="val">Valenci√†</option>
                </select>
            </div>
            <div class="grupo-botones" id="category-names-group">
                <h3>Nombres de columnas</h3>
                <label for="category-name-en-preparacion">En preparaci√≥n</label>
                <input type="text" id="category-name-en-preparacion" data-category-key="en-preparacion" maxlength="80" />
                <label for="category-name-preparadas">Preparadas</label>
                <input type="text" id="category-name-preparadas" data-category-key="preparadas" maxlength="80" />
                <label for="category-name-en-proceso">En proceso</label>
                <input type="text" id="category-name-en-proceso" data-category-key="en-proceso" maxlength="80" />
                <label for="category-name-pendientes">Pendientes</label>
                <input type="text" id="category-name-pendientes" data-category-key="pendientes" maxlength="80" />
                <button type="button" id="category-names-reset" class="boton-accion">Restaurar nombres por defecto</button>
            </div>
            <div class="grupo-botones" id="sync-group-modal">
                <h3>Sincronizaci√≥n</h3>
                <div class="sync-provider" id="dropbox-sync-section">
                    <h4>Dropbox</h4>
                    <p class="sync-helper">Sincroniza autom√°ticamente tus datos mediante OAuth.</p>
                    <button id="dropbox-login" type="button" class="boton-accion">Conectar con Dropbox</button>
                    <button id="dropbox-sync" type="button" class="boton-accion" style="display:none;">Sincronizar</button>
                </div>
                <div class="sync-provider" id="nextcloud-sync-section">
                    <h4>Nextcloud (WebDAV)</h4>
                    <p class="sync-helper">Introduce la URL de tu servidor, usuario y contrase√±a o token de aplicaci√≥n.</p>
                    <label for="nextcloud-url">URL de Nextcloud</label>
                    <input id="nextcloud-url" type="url" placeholder="https://cloud.ejemplo.com" autocomplete="url">
                    <label for="nextcloud-username">Usuario</label>
                    <input id="nextcloud-username" type="text" placeholder="usuario" autocomplete="username">
                    <label for="nextcloud-password">Contrase√±a o token de aplicaci√≥n</label>
                    <input id="nextcloud-password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
                    <label for="nextcloud-folder">Carpeta (opcional)</label>
                    <input id="nextcloud-folder" type="text" placeholder="/Apps/EduKanban">
                    <div class="sync-actions">
                        <button id="nextcloud-save" type="button" class="boton-accion">Guardar ajustes</button>
                        <button id="nextcloud-sync" type="button" class="boton-accion" style="display:none;">Sincronizar</button>
                        <button id="nextcloud-disconnect" type="button" class="boton-accion boton-peligro" style="display:none;">Desconectar</button>
                    </div>
                    <div id="nextcloud-status" class="sync-status" role="status" aria-live="polite"></div>
                </div>
            </div>
            <div class="grupo-botones" id="backup-group">
                <h3>Copia de seguridad</h3>
                <button id="backup-export" type="button" class="boton-accion">üì§ Exportar copia</button>
                <button id="backup-import" type="button" class="boton-accion">üì• Importar copia</button>
                <input id="backup-file-input" type="file" accept="application/json" style="display:none" />
            </div>
            <div class="grupo-botones" id="shortcuts-group">
                <h3>Atajos de teclado</h3>
                <button id="abrir-atajos" type="button" class="boton-accion" aria-haspopup="dialog" aria-controls="atajos-modal">‚å®Ô∏è Ver atajos</button>
            </div>
            <div class="acciones-popup">
                <button type="button" id="admin-close">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Modal de atajos de teclado -->
    <div id="atajos-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="atajos-titulo">
        <div class="modal-content atajos-modal-content">
            <h2 id="atajos-titulo">Atajos de teclado</h2>
            <p>Puedes consultar estos atajos cuando quieras acelerar tu trabajo.</p>
            <ul class="keyboard-shortcuts">
                <li>
                    <div class="shortcut-keys">
                        <kbd>Alt</kbd>
                        <span class="shortcut-plus">+</span>
                        <kbd>N</kbd>
                    </div>
                    <p class="shortcut-desc">Abrir el formulario para crear una nueva actividad.</p>
                </li>
                <li>
                    <div class="shortcut-keys">
                        <kbd>Alt</kbd>
                        <span class="shortcut-plus">+</span>
                        <kbd>‚Üë</kbd>
                    </div>
                    <p class="shortcut-desc">Subir en 0,10&times; la velocidad del √∫ltimo audio o v√≠deo activo.</p>
                </li>
                <li>
                    <div class="shortcut-keys">
                        <kbd>Alt</kbd>
                        <span class="shortcut-plus">+</span>
                        <kbd>‚Üì</kbd>
                    </div>
                    <p class="shortcut-desc">Bajar en 0,10&times; la velocidad del √∫ltimo audio o v√≠deo activo.</p>
                </li>
                <li>
                    <div class="shortcut-keys">
                        <kbd>.</kbd>
                    </div>
                    <p class="shortcut-desc">Con el audio o v√≠deo enfocado, subir la velocidad en 0,10&times;.</p>
                </li>
                <li>
                    <div class="shortcut-keys">
                        <kbd>,</kbd>
                    </div>
                    <p class="shortcut-desc">Con el audio o v√≠deo enfocado, bajar la velocidad en 0,10&times;.</p>
                </li>
                <li>
                    <div class="shortcut-keys">
                        <kbd>Esc</kbd>
                    </div>
                    <p class="shortcut-desc">Cerrar modales abiertos (nueva tarea, atajos, visor de im√°genes, confirmaciones).</p>
                </li>
            </ul>
            <div class="acciones-popup">
                <button type="button" id="atajos-cerrar" class="boton-accion">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Visor de imagen a pantalla casi completa -->
    <div id="image-lightbox" class="modal image-lightbox" style="display:none">
        <img id="image-lightbox-img" alt="preview" />
    </div>

    <footer>
        <script src="js/i18n.js"></script>
        <script src="js/app.js"></script>
        <script src="js/sw-register.js"></script> <span id="sw-version"></span>
    </footer>

</body>
</html>
